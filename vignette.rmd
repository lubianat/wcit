
Let's try and find the indentity of the clusters below



```{r}
library(Seurat)
library(dplyr)
data("pbmc_small")

pbmc_small@active.ident
TSNEPlot(pbmc_small, do.label = T)

```



First, let's detect the markers.

```{r}
pbmc_markers <- Seurat::FindAllMarkers(pbmc_small)

```

So these are the markers for the different clusters. Let's run wcit and see if we can infer which type of cells they are most similar to. 

```{r}
library(wcit)
for (i in levels(pbmc_markers$cluster)){
  print(paste('For cluster', i, 'The most likely cell types are:'))
  wcit(pbmc_markers$gene[pbmc_markers$cluster == i])
}
```

Let's manually look at the markers, as it is done normally.

```{r}
for (i in levels(markers$cluster)){
  print(markers$gene[markers$cluster == i][1:10])
}
```

Cluster 0 has as markers  HLA and LYZ, pointing to macrophages/monocytes or dendritic cells.
Cluster 1  expresses S100A9, LST1, AIF1, pointing to monocytes.
Cluster 2 expresses CD79A and CD79B, pointin indeed to B cells.

Let's run the wcit magic 
```{r}
pbmc_small_after_magic <- wcit_magic(pbmc_small)

```


